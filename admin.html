<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>å¤œé£Ÿå–ã‚Šç½®ã ç®¡ç†ç”»é¢</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f5f5f5;
      color: #111;
    }

    .admin-shell {
      max-width: 960px;
      margin: 0 auto;
      min-height: 100vh;
      padding: 16px 12px 40px;
    }

    h1 {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 12px;
    }

    .admin-sub {
      font-size: 12px;
      color: #666;
      margin-bottom: 16px;
    }

    /* ã‚¿ãƒ– */
    .admin-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
    }
    .admin-tab {
      padding: 8px 14px;
      border-radius: 999px;
      border: 1px solid #ddd;
      background: #fff;
      font-size: 13px;
      cursor: pointer;
    }
    .admin-tab.active {
      background: #111;
      color: #fff;
      border-color: #111;
      font-weight: 600;
    }

    .admin-panel {
      background: #fff;
      border-radius: 16px;
      padding: 14px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.06);
      margin-bottom: 16px;
    }

    /* å•†å“ãƒ†ãƒ¼ãƒ–ãƒ« */
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
      margin-top: 8px;
    }
    th, td {
      border-bottom: 1px solid #eee;
      padding: 6px 4px;
      text-align: left;
    }
    th {
      background: #fafafa;
      font-weight: 600;
      font-size: 12px;
    }

    .btn {
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
    }
    .btn-primary {
      background: #111;
      color: #fff;
      font-weight: 600;
    }
    .btn-secondary {
      background: #f3f3f3;
      color: #111;
      border: 1px solid #ddd;
    }
    .btn-danger {
      background: #fce4e4;
      color: #b00020;
      border: 1px solid #f5b5b5;
    }

    .btn-row {
      display: flex;
      gap: 8px;
      margin-top: 10px;
      margin-bottom: 4px;
    }

    /* ãƒ•ã‚©ãƒ¼ãƒ  */
    .form-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 8px;
    }
    .form-group {
      flex: 1 1 180px;
    }
    .form-label {
      font-size: 11px;
      margin-bottom: 2px;
      color: #555;
    }
    .form-input, .form-select, .form-textarea {
      width: 100%;
      padding: 6px 8px;
      border-radius: 6px;
      border: 1px solid #ddd;
      font-size: 13px;
    }
    .form-textarea {
      min-height: 60px;
      resize: vertical;
    }

    .badge-pill {
      display: inline-block;
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 999px;
      background: #f5f5f5;
      border: 1px solid #eee;
      margin-right: 4px;
      margin-top: 4px;
    }

    /* JSONè¡¨ç¤º */
    .json-area {
      margin-top: 8px;
    }
    .json-area textarea {
      width: 100%;
      min-height: 120px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
      padding: 6px 8px;
      border-radius: 6px;
      border: 1px solid #ddd;
      background: #fafafa;
      white-space: pre;
    }

    /* Storeãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ */
    .store-preview {
      margin-top: 12px;
      border-radius: 16px;
      border: 1px solid #eee;
      padding: 10px;
      background: #fafafa;
    }
    .store-preview-name {
      font-size: 15px;
      font-weight: 700;
    }
    .store-preview-sub {
      font-size: 12px;
      color: #666;
      margin-top: 2px;
    }
    .store-preview-chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin: 8px 0;
    }
    .store-preview-chip {
      font-size: 11px;
      padding: 4px 8px;
      border-radius: 999px;
      background: #fff;
      border: 1px solid #eee;
    }
    .store-preview-map {
      margin-top: 8px;
      border-radius: 12px;
      overflow: hidden;
      background: #ddd;
    }
    .store-preview-map iframe {
      width: 100%;
      height: 200px;
      border: 0;
    }

    .hidden { display: none; }
  </style>
</head>
<body>
<div class="admin-shell">
  <h1>å¤œé£Ÿå–ã‚Šç½®ã ç®¡ç†ç”»é¢</h1>
  <div class="admin-sub">
    å•†å“ã‚„åº—èˆ—æƒ…å ±ã‚’ã“ã“ã§ç·¨é›†ã—ã¾ã™ã€‚<br>
    ã¾ã ã‚µãƒ¼ãƒãƒ¼é€£æºã¯ã—ã¦ã„ãªã„ã®ã§ã€å¿…è¦ã«å¿œã˜ã¦ JSON ã‚’æœ¬ç•ªãƒšãƒ¼ã‚¸ã«ã‚³ãƒ”ãƒšã—ã¦ãã ã•ã„ã€‚
  </div>

  <!-- ã‚¿ãƒ– -->
  <div class="admin-tabs">
    <button class="admin-tab active" data-panel="itemsPanel">ğŸ›’ å•†å“ç®¡ç†</button>
    <button class="admin-tab" data-panel="storePanel">ğŸª Store æƒ…å ±</button>
  </div>

  <!-- å•†å“ç®¡ç†ãƒ‘ãƒãƒ« -->
  <section id="itemsPanel" class="admin-panel">
    <div class="btn-row">
      <button class="btn btn-primary" id="addItemBtn">ï¼‹ å•†å“è¿½åŠ </button>
      <button class="btn btn-secondary" id="showJsonBtn">ITEMS JSON ã‚’è¡¨ç¤º</button>
    </div>

    <table>
      <thead>
        <tr>
          <th style="width: 80px;">ID</th>
          <th>å•†å“å</th>
          <th style="width: 120px;">ã‚«ãƒ†ã‚´ãƒª</th>
          <th style="width: 80px;">ä¾¡æ ¼</th>
          <th style="width: 120px;">æ“ä½œ</th>
        </tr>
      </thead>
      <tbody id="itemsTableBody">
      </tbody>
    </table>

    <div class="json-area hidden" id="jsonArea">
      <p style="font-size:11px;color:#666;margin-bottom:4px;">
        ã“ã® JSON ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã€æœ¬ç•ªãƒšãƒ¼ã‚¸ã® <code>ITEMS</code> é…åˆ—ã«è²¼ã‚Šä»˜ã‘ã‚Œã°åŒæœŸã§ãã¾ã™ã€‚
      </p>
      <textarea id="itemsJsonOutput" readonly></textarea>
    </div>
  </section>

  <!-- Store æƒ…å ±ãƒ‘ãƒãƒ« -->
  <section id="storePanel" class="admin-panel hidden">
    <div class="form-row">
      <div class="form-group">
        <label class="form-label">åº—å</label>
        <input id="storeNameInput" class="form-input" value="ãƒ­ãƒ¼ã‚½ãƒ³ å—éƒ¨ã®é‡Œåº—">
      </div>
      <div class="form-group">
        <label class="form-label">ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼ä¸‹ï¼‰</label>
        <input id="storeSubInput" class="form-input" value="ãƒ­ãƒ¼ã‚½ãƒ³ å—éƒ¨ã®é‡Œåº— ãƒ» åº—é ­å—ã‘å–ã‚Š">
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label class="form-label">ä½æ‰€</label>
        <textarea id="storeAddressInput" class="form-textarea">é³¥å–çœŒè¥¿ä¼¯éƒ¡å—éƒ¨ç”ºã€‡ã€‡ã€‡ã€‡</textarea>
      </div>
      <div class="form-group">
        <label class="form-label">ã‚¢ã‚¯ã‚»ã‚¹èª¬æ˜</label>
        <textarea id="storeAccessInput" class="form-textarea">â—‹â—‹äº¤å·®ç‚¹ã‹ã‚‰è»Šã§ç´„3åˆ†ã€‚ãƒ­ãƒ¼ã‚½ãƒ³å—éƒ¨ã®é‡Œåº—ã®ãƒ¬ã‚¸ã§ãŠå—ã‘å–ã‚Šãã ã•ã„ã€‚</textarea>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label class="form-label">Google Maps åŸ‹ã‚è¾¼ã¿ URLï¼ˆiframe ã® srcï¼‰</label>
        <textarea id="storeMapEmbedInput" class="form-textarea"></textarea>
      </div>
      <div class="form-group">
        <label class="form-label">Google Maps ã‚¢ãƒ—ãƒªç”¨ãƒªãƒ³ã‚¯</label>
        <input id="storeMapLinkInput" class="form-input" value="https://maps.google.com/?q=ãƒ­ãƒ¼ã‚½ãƒ³ å—éƒ¨ã®é‡Œåº—">
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label class="form-label">ãƒãƒƒãƒ—ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰</label>
        <input id="storeChipsInput" class="form-input" value="åº—é ­å—ã‘å–ã‚Šå°‚ç”¨,24æ™‚é–“å–¶æ¥­,é§è»Šå ´ã‚ã‚Š">
      </div>
    </div>

    <div class="btn-row">
      <button class="btn btn-primary" id="updateStorePreviewBtn">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°</button>
    </div>

    <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ -->
    <div class="store-preview" id="storePreview">
      <div class="store-preview-name">ãƒ­ãƒ¼ã‚½ãƒ³ å—éƒ¨ã®é‡Œåº—</div>
      <div class="store-preview-sub">ãƒ­ãƒ¼ã‚½ãƒ³ å—éƒ¨ã®é‡Œåº— ãƒ» åº—é ­å—ã‘å–ã‚Š</div>
      <div class="store-preview-chip-row" id="storePreviewChips"></div>
      <div style="font-size:12px;margin-top:4px;">
        <span style="font-weight:600;font-size:11px;">ä½æ‰€ï¼š</span>
        <span id="storePreviewAddress"></span>
      </div>
      <div style="font-size:12px;margin-top:2px;">
        <span style="font-weight:600;font-size:11px;">ã‚¢ã‚¯ã‚»ã‚¹ï¼š</span>
        <span id="storePreviewAccess"></span>
      </div>
      <div class="store-preview-map" id="storePreviewMap">
        <iframe src="" loading="lazy"></iframe>
      </div>
    </div>
  </section>
</div>

<script>
  // ====== ä»®ã®ã‚¢ã‚¤ãƒ†ãƒ ãƒ‡ãƒ¼ã‚¿ï¼ˆä»Šã®æœ¬ç•ªã‹ã‚‰ã‚³ãƒ”ãƒšã—ã¦OKï¼‰ ======
  let items = [
    {
      id: "hs-01",
      name: "ã‹ã‚‰ã‚ã’ã‚¯ãƒ³ ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼",
      category: "hotsnack",
      price: 240,
      desc: "å®šç•ªäººæ°—ã®ãƒ›ãƒƒãƒˆã‚¹ãƒŠãƒƒã‚¯ã€‚",
      tag: "ãƒ›ãƒƒãƒˆã‚¹ãƒŠãƒƒã‚¯"
    },
    {
      id: "hs-02",
      name: "Lãƒã‚­ ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼",
      category: "hotsnack",
      price: 238,
      desc: "ã‚¸ãƒ¥ãƒ¼ã‚·ãƒ¼ãªãƒ•ãƒ©ã‚¤ãƒ‰ãƒã‚­ãƒ³ã€‚",
      tag: "ãƒ›ãƒƒãƒˆã‚¹ãƒŠãƒƒã‚¯"
    },
    {
      id: "dr-01",
      name: "ã‚¢ã‚¤ã‚¹ã‚³ãƒ¼ãƒ’ãƒ¼ M",
      category: "drink",
      price: 180,
      desc: "ã‚¹ãƒƒã‚­ãƒªè‹¦å‘³ã®ã‚ã‚‹ã‚³ãƒ¼ãƒ’ãƒ¼ã€‚",
      tag: "ãƒ‰ãƒªãƒ³ã‚¯"
    },
    {
      id: "br-01",
      name: "ãµã‚“ã‚ã‚ŠãŸã¾ã”ã‚µãƒ³ãƒ‰",
      category: "bread",
      price: 268,
      desc: "ãŸã¾ã”ãŸã£ã·ã‚Šã®ã‚µãƒ³ãƒ‰ã‚¤ãƒƒãƒã€‚",
      tag: "ãƒ‘ãƒ³"
    },
    {
      id: "lm-01",
      name: "çˆ†ç››ã‚Šã‹ã‚‰æšã’å¼å½“ï¼ˆå–ã‚Šç½®ãé™å®šï¼‰",
      category: "limited",
      price: 598,
      desc: "å–ã‚Šç½®ãé™å®šã®ã‚¹ãƒšã‚·ãƒ£ãƒ«å¼å½“ã€‚",
      tag: "é™å®š"
    }
  ];

  // localStorage ã‹ã‚‰å¾©å…ƒï¼ˆã‚ã‚Œã°ï¼‰
  const saved = localStorage.getItem("yasoku-admin-items");
  if (saved) {
    try {
      items = JSON.parse(saved);
    } catch (e) {}
  }

  // ====== ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ ======
  document.querySelectorAll(".admin-tab").forEach(tab => {
    tab.addEventListener("click", () => {
      document.querySelectorAll(".admin-tab").forEach(t => t.classList.remove("active"));
      tab.classList.add("active");

      const panelId = tab.getAttribute("data-panel");
      document.querySelectorAll(".admin-panel").forEach(p => p.classList.add("hidden"));
      document.getElementById(panelId).classList.remove("hidden");
    });
  });

  // ====== å•†å“ä¸€è¦§ ======
  const itemsTableBody = document.getElementById("itemsTableBody");

  function saveItems() {
    localStorage.setItem("yasoku-admin-items", JSON.stringify(items));
  }

  function renderItemsTable() {
    itemsTableBody.innerHTML = "";
    items.forEach((it, index) => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${it.id}</td>
        <td>${it.name}</td>
        <td>${it.category}</td>
        <td>Â¥${it.price}</td>
        <td>
          <button class="btn btn-secondary" data-action="edit" data-index="${index}">ç·¨é›†</button>
          <button class="btn btn-danger" data-action="delete" data-index="${index}">å‰Šé™¤</button>
        </td>
      `;
      itemsTableBody.appendChild(tr);
    });
  }

  renderItemsTable();

  // ç·¨é›†ãƒ»å‰Šé™¤ã‚¤ãƒ™ãƒ³ãƒˆ
  itemsTableBody.addEventListener("click", (e) => {
    const btn = e.target.closest("button");
    if (!btn) return;
    const index = Number(btn.getAttribute("data-index"));
    const action = btn.getAttribute("data-action");
    const item = items[index];

    if (action === "edit") {
      const id = prompt("ID", item.id);
      if (!id) return;
      const name = prompt("å•†å“å", item.name) ?? item.name;
      const category = prompt("ã‚«ãƒ†ã‚´ãƒª (hotsnack / drink / bread / limited)", item.category) ?? item.category;
      const priceStr = prompt("ä¾¡æ ¼ï¼ˆåŠè§’æ•°å­—ï¼‰", item.price);
      const price = Number(priceStr || item.price);

      item.id = id;
      item.name = name;
      item.category = category;
      item.price = price;

      saveItems();
      renderItemsTable();
    }

    if (action === "delete") {
      if (!confirm("ã“ã®å•†å“ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")) return;
      items.splice(index, 1);
      saveItems();
      renderItemsTable();
    }
  });

  // å•†å“è¿½åŠ 
  document.getElementById("addItemBtn").addEventListener("click", () => {
    const id = prompt("IDï¼ˆä¾‹ï¼šhs-03ï¼‰");
    if (!id) return;
    const name = prompt("å•†å“å");
    if (!name) return;
    const category = prompt("ã‚«ãƒ†ã‚´ãƒª (hotsnack / drink / bread / limited)", "hotsnack") || "hotsnack";
    const priceStr = prompt("ä¾¡æ ¼ï¼ˆåŠè§’æ•°å­—ï¼‰", "200");
    const price = Number(priceStr || 0);

    items.push({
      id,
      name,
      category,
      price,
      desc: "",
      tag: ""
    });
    saveItems();
    renderItemsTable();
  });

  // JSONè¡¨ç¤º
  const jsonArea = document.getElementById("jsonArea");
  const itemsJsonOutput = document.getElementById("itemsJsonOutput");

  document.getElementById("showJsonBtn").addEventListener("click", () => {
    jsonArea.classList.toggle("hidden");
    if (!jsonArea.classList.contains("hidden")) {
      itemsJsonOutput.value = JSON.stringify(items, null, 2);
    }
  });

  // ====== Store æƒ…å ± ======
  const storeNameInput   = document.getElementById("storeNameInput");
  const storeSubInput    = document.getElementById("storeSubInput");
  const storeAddressInput= document.getElementById("storeAddressInput");
  const storeAccessInput = document.getElementById("storeAccessInput");
  const storeMapEmbedInput = document.getElementById("storeMapEmbedInput");
  const storeMapLinkInput  = document.getElementById("storeMapLinkInput");
  const storeChipsInput    = document.getElementById("storeChipsInput");

  const storePreviewName    = document.getElementById("storePreview").querySelector(".store-preview-name");
  const storePreviewSub     = document.getElementById("storePreview").querySelector(".store-preview-sub");
  const storePreviewChips   = document.getElementById("storePreviewChips");
  const storePreviewAddress = document.getElementById("storePreviewAddress");
  const storePreviewAccess  = document.getElementById("storePreviewAccess");
  const storePreviewMap     = document.getElementById("storePreviewMap").querySelector("iframe");

  function updateStorePreview() {
    storePreviewName.textContent = storeNameInput.value || "åº—å";
    storePreviewSub.textContent  = storeSubInput.value || "";
    storePreviewAddress.textContent = storeAddressInput.value || "";
    storePreviewAccess.textContent  = storeAccessInput.value || "";

    storePreviewChips.innerHTML = "";
    const chips = (storeChipsInput.value || "").split(",").map(s => s.trim()).filter(Boolean);
    chips.forEach(c => {
      const span = document.createElement("span");
      span.className = "store-preview-chip";
      span.textContent = c;
      storePreviewChips.appendChild(span);
    });

    const src = storeMapEmbedInput.value.trim();
    if (src) {
      storePreviewMap.src = src;
    }
  }

  document.getElementById("updateStorePreviewBtn").addEventListener("click", () => {
    updateStorePreview();
    alert("ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚\nå¿…è¦ãªã‚‰ã€ã“ã®å†…å®¹ã‚’æœ¬ç•ªã® storeView ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚³ãƒ”ãƒšã—ã¦ãã ã•ã„ã€‚");
  });

  // åˆæœŸãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
  updateStorePreview();
</script>
</body>
</html>
<!-- refresh -->
